@using SkillsHub.Domain.BaseModels;
@using SkillsHub.Application;


@model (IQueryable<ApplicationUser>,IQueryable<Student>)
@{
    var Users = Model.Item1.ToArray();
    var Students = Model.Item2.ToArray();
}
    <!-- Custom Stylesheet -->
    <link href="/plugins/tables/css/datatable/dataTables.bootstrap4.min.css" rel="stylesheet">

<div>
    <div>

        <div class="row page-titles mx-0">
            <div class="col p-md-0">
                <ol class="breadcrumb" style="display:flex;align-items:center">
                    <li class="breadcrumb-item"><a href="javascript:void(0)">Dashboard</a></li>
                    <li class="breadcrumb-item active"><a href="javascript:void(0)">Home</a></li>
                    <li>
                        <div class="dropdown">
                            <a style="margin-left:20px" class="btn btn-secondary dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                Action
                            </a>

                            <ul class="dropdown-menu">
                                <form>
                                <li><a class="dropdown-item" href="#">Invite via email</a></li>
                                <li>

                                    <a class="dropdown-item" asp-action="Create" asp-controller="Account">Create new</a>

                                </li>
                                </form>
                            </ul>

                        </div>
                    </li>
                    <li>
                        <form>
                   
                        <a class="dropdown-item" asp-action="Create" asp-controller="Account">Create new</a>

                    </form>
                    </li>

                </ol>
            </div>
        </div>
                    @{
            if (Model.Item2 == null || Model.Item2.Count() == 0)
        {

                <div style=" display:flex;flex;grid-gap:20px;justify-content:center ">
                    <h3>Student`s list is empty</h3>
                </div>

            }
            else{

                <div class="container-fluid">
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <h4 class="card-title">Students</h4>
                                    <div class="table-responsive">
                                        <table class="table table-striped table-bordered zero-configuration">
                                            <thead>
                                                <tr>
                                                    <th>Login</th>
                                                    <th>Full Name</th>
                                                    <th>Sex</th>
                                                    <th>Phone</th>
                                                    <th>Email</th>
                                                    <th>BirthDate</th>
                                                    <th>Age</th>
                                                    <th>Status</th>
                                                    <th>Groups</th>
                                                    <th>Teacher</th>
                                                    <!--<th>Student</th>-->
                                                    <th>Total Lessons</th>
                                                    <th>Month Lessons</th>
                                                    <th>Payment</th>
                                                    <th>Date Register</th>
                                                    <th>External connections</th>
                                                    <th>IsDeleted</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @{
                                                    for (int i = 0; i < Users.Count(); i++) 
                                                    {

                                                           /* <tr>
                                                                <td>Tiger Nixon</td>
                                                                <td>System Architect</td>
                                                                <td>Edinburgh</td>
                                                                <td>61</td>
                                                                <td>2011/04/25</td>
                                                                <td>$320,800</td>
                                                            </tr>
                                                            */
                                                            <tr>
                                                            <td><a asp-action="Item" asp-controller="Account" asp-route-itemId="@Users[i].Id" style="font-weight:900;color:#7571f9">  @Users[i].Login </a></td>
                                                            <td>@Users[i].FirstName @Users[i].LastName @Users[i].Surname</td>
                                                            <td>@Users[i].Sex</td>
                                                            <td>@Users[i].Phone</td>
                                                            <td>@Users[i].Email</td>
                                                            <td>@Users[i].BirthDate</td>
                                                            <td>@(DateTime.Today.Year - Users[i].BirthDate.Year)</td>
                                                                <td>@if(Students[i].Groups == null){ <p>Not studiet</p>  } else { <p>Studiet</p>}</td>
                                                                <td>@if(Students[i].Groups != null){ foreach(var a in Students[i].Groups) { <p>@a.Name</p> }} </td>
                                                            <td>
                                                            @if (Students[i].Lessons != null) 
                                                            { Students[i].Lessons.Count(); }  
                                                            else{<div> -- </div>}

                                                            </td> <!--{foreach(var les in Students[i].Lessons) {<a asp-action="Item" asp-controller="Classes" asp-route-itemid="Students[i].Groups.Id">les.StartTime</a>}}-->
                                                            <td>@if(Students[i].Lessons != null){ <p>Students[i].Lessons.Count()</p>}</td>
                                                                <td>@if(Students[i].Lessons != null){ <p>@Students[i].Lessons.Where(x=>x.StartTime.Month == DateTime.Today.Month).Count()</p>}</td>
                                                                <td>0 payed</td>
                                                                <td>@Students[i].DateCreated</td>
                                                                <td>---</td>
                                                                <td>@Students[i].IsDeleted</td>
                                                            </tr>
                                            }
                                        }
                                        </tbody>
                                        <tfoot>
                                                <tr>
                                                    <th>Login</th>
                                                    <th>Full Name</th>
                                                    <th>Sex</th>
                                                    <th>Phone</th>
                                                    <th>Email</th>
                                                    <th>BirthDate</th>
                                                    <th>Age</th>
                                                    <th>Status</th>
                                                    <th>Groups</th>
                                                    <th>Teacher</th>
                                                    <!--<th>Student</th>-->
                                                    <th>Total Lessons</th>
                                                    <th>Student`s Lessons</th>
                                                    <th>Payment</th>
                                                    <th>Date Register</th>
                                                    <th>External connections</th>
                                                    <th>IsDeleted</th>
                                                </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- #/ container -->
            }
        }
        </div>
        
    </div>

<script type="text/javascript" src="~/Scripts/jquery-1.10.2.min.js"></script>

