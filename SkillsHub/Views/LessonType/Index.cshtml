@using SkillsHub.Domain.BaseModels;
@model IQueryable<LessonType>;
@inject Microsoft.AspNetCore.Identity.SignInManager<ApplicationUser> _roleManager;
@inject SkillsHub.Persistence.ApplicationDbContext _context;


<style>
th,td {
    text-wrap:nowrap
}

</style>

    @{
        var items = Model.ToList() ?? new List<LessonType>();

     }
        
        
                
 <div class="container-fluid">
     <div class="row">
         <div class="col-12">
             <div class="card">
                 <div class="card-body">
             <div style="display:flex; justify-content:space-between;align-items:center;margin:5px">
                 <h2 class="card-title">Категории занятий</h2>
                 <form>
                     <div><input type="button" class="btn btn-primary" value="+" onclick="Create()"/></div>
                 </form>
             </div>
                     
                             <div class="table-responsive">
                                 <table class="table table-striped table-bordered zero-configuration">
                                     <thead>
                                         <tr>
                                             <th>Active</th> <!--Change color-->
                                             <th>Full Name</th> <!--Change color-->
                                             <th>Course</th>
                                             <th>Age type</th>
                                             <th>Group type</th>
                                             <th>Location</th>
                                             <th>Lesson`s duration</th>
                                             <th>Payment categories</th>
                                             <th>Last update</th>
                                             <th></th>
                                             <!--
                                             <th>Count teachers/students/groups</th>
                                             <th>Actions</th>-->
                                         </tr>
                                     </thead>
                             <tbody id="partialContainer">
 
                     
                                     @foreach (var item in items)
                     {
                             <tr>
                                 <form id="@item.Id">
                                              <input type="hidden" asp-for="@item.Id"/>
                                
                                             <td>
                                                 <input type="checkbox" asp-for="@item.IsActive" />
                                             </td>
                                             <td>
                                                 @if (item.IsDeleted == false)
                                 {
                                                     <a asp-action="Item" asp-controller="Account" asp-route-itemId="@item.Id" style="font-weight:900;color:#7571f9">  @item.Name </a>
 
                                 }
                                 else
                                 {
                                                     <a asp-action="Item" asp-controller="Account" asp-route-itemId="@item.Id" style="font-weight:900;color:red">  @item.Name </a>
                                 }
                                             </td>
                                             <td>
                                        
                                                <select class="form-select" asp-for="@item.CourseId"></select>
                                             </td>
                                             <td>
                                                  <select class="form-select" asp-for="@item.AgeTypeId" onchange="getAgeTypes()"></select >
                                             </td>
                                             <td>
                                                 <select class="form-select" asp-for="@item.GroupTypeId"></select>
                                                  <!--
                                                 <button type="button" onclick="getAgeTypes()" class="btn btn-primary" style="zoom:60%">
                                                     <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
                                                         <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z" />
                                                         <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466" />
                                                     </svg>
                                                 </button>-->
                                             </td>
                                             <td>
                                                  <select class="form-select" asp-for="@item.LocationId" onchange="getLocations()"></select >
                                             </td>
                                             <td><input class="form-control"  asp-for="@item.LessonTimeInMinutes" min="10"/></td>
                                             <td>
 
 
                                     
                                               <select class="selectpicker" multiple aria-label="Default select example" data-live-search="true">
                                                 <option value="1">One</option>
                                                 <option value="2">Two</option>
                                                 <option value="3">Three</option>
                                                 <option value="4">Four</option>
                                                 @foreach (var pCat in _context.PaymentCategories.Where(x => !x.IsDeleted))
                                         {
                                                 <option name="paymentCategory" value="@pCat.Id">@pCat.Name</option>
                                         }
 
                                               </select>
                                    
                             
                                             </td>
                                             <td>@item.DateCreated</td>
                                             <td style="display:flex">
                                             <input type="button" class="btn btn-success" value="Сохранить"/>
                                             <input type="button" class="btn btn-danger" value="Х" />
                                             </td>
                                     
                                 
                                 </form>
                             </tr>
                     }
                             </tbody>
                             <tfoot>
                                 <tr>
                                     <th>Active</th> <!--Change color-->
                                     <th>Full Name</th> <!--Change color-->
                                     <th>Course</th>
                                     <th>Age type</th>
                                     <th>Group type</th>
                                     <th>Location</th>
                                     <th>Lesson`s duration</th>
                                     <th>Payment categories</th>
                                     <th>Last update</th>
                                     <th></th>
                                     <!--
                                     <th>Count teachers/students/groups</th>
                                     <th>Actions</th>-->
                                 </tr>
                             </tfoot>
                         </table>
                     </div>
                 </div>
             </div>
         </div>
     </div>
 </div>

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title">Users</h4>


                </div>
            </div>
        </div> 
    </div>
</div>

    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>

        function Create(){
        $.get('/LessonType/CreateRowAsync', function (data) {
        $('#partialContainer').append(data);
        });
        } 




        var filters_LessonType = {
        "filter-subjectId": $("#subject-select option:selected").val(),
        "filter-courseId": $("#course-select option:selected").val(),
        "filter-groupTypeId": $("#groupType-select option:selected").val(),
        "filter-locationType": $("#locationType-select option:selected").val(),
        "filter-ageTypeId": $("#ageType-select option:selected").val(),
        "IsDeleted": '-'

        }
        var orders = {
        OrderColumn: "Id",
        OrderType: "asc",
        }


        function getAgeTypes() {
        $("#ageType-select").load("/AgeTypes/OptionsList", { itemId : $("#subject-select option:selected").val() })
        }
        function getGroupTypes() {
        $("#groupType-select").load("/AgeTypes/OptionsList", { itemId : $("#subject-select option:selected").val() })
        }
        function getCourses() {
        $("#courses-select").load("/AgeTypes/OptionsList", { itemId : $("#subject-select option:selected").val() })
        }

        //---------------------------------------------------------------





        function GetSubjects() {
            console.log($("#subject-select option:selected").val());
            console.log(typeof ($("#subject-select option:selected").val()))

            $("#subject-select").load("/Subject/OptionsList", { subjectId: $("#subject-select option:selected").val() }, function (responseTxt, statusTxt, xhr) {
            if (statusTxt == "success")
            console.log("External content loaded successfully!");
            if (statusTxt == "error")
            console.log("Error: " + xhr.status + ": " + xhr.statusText);
            })
        };

        


                    //LessonType - Row

            </script>

